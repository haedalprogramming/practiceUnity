# 6-7ê¹Œì§€ í•œë²ˆì— ê°€ë¥´ì¹˜ë©´ ë¨

# ğŸ•¹ï¸ ì‹¤ìŠµ: 3D ë¯¸ì…˜ 2ì¢… ì œì‘ (ì í”„, ìˆ˜ì§‘)

> ê°„ë‹¨í•œ 3D ê²Œì„ í”Œë ˆì´ ìš”ì†Œì¸ "ì í”„ ë¯¸ì…˜"ê³¼ "ì•„ì´í…œ ìˆ˜ì§‘ ë¯¸ì…˜"ì„ êµ¬í˜„í•˜ë©° Unityì˜ ê¸°ë³¸ ë¬¼ë¦¬ ë° ì…ë ¥ ì‹œìŠ¤í…œì„ ì‹¤ìŠµí•©ë‹ˆë‹¤.

---

## ğŸ¯ ëª©í‘œ

- 3D ìºë¦­í„° ì»¨íŠ¸ë¡¤ êµ¬í˜„ (ì í”„ í¬í•¨)
- íŠ¸ë¦¬ê±°(Trigger)ë¥¼ ì´ìš©í•œ ì•„ì´í…œ ìˆ˜ì§‘ ì‹œìŠ¤í…œ êµ¬ì¶•
- ê°„ë‹¨í•œ UI í…ìŠ¤íŠ¸ë¡œ ì ìˆ˜ í‘œì‹œ
- ì í”„ì™€ ì•„ì´í…œ ìˆ˜ì§‘ ê¸°ëŠ¥ì´ ê°™ì´ ìˆëŠ” ê²Œì„ ì œì‘
---

## 1. ë¯¸ì…˜ 1: ì í”„ ì•¡ì…˜ êµ¬í˜„

### âœ… ìš”êµ¬ ì‚¬í•­

- ìŠ¤í˜ì´ìŠ¤ë°”ë¥¼ ëˆ„ë¥´ë©´ ìºë¦­í„°ê°€ ì í”„
- ë•…ì— ë‹¿ì•„ ìˆì„ ë•Œë§Œ ì í”„ ê°€ëŠ¥
- ì í”„ ì¿¨íƒ€ì„ ë˜ëŠ” ì¤‘ë³µ ì í”„ ë°©ì§€


### ğŸ› ï¸ ì£¼ìš” êµ¬ì„± ìš”ì†Œ 1: 3ì¸ì¹­ ì‹œì 

- `Cinemachine`ì˜ `FreeLockCamera`ë¡œ 3ì¸ì¹­ ì‹œì  êµ¬í˜„.(ìƒ˜í”Œë¡œ ë§Œë“  ì”¬ ë³´ì—¬ì¤˜ì„œ ì–´ë–»ê²Œ 3ì¸ì¹­ ì‹œì ì´ ì‘ë™í•˜ë©´ ë˜ëŠ”ê°€ ë³´ì—¬ì£¼ê¸°+ìºë¦­í„° ê²Œì„ì˜¤ë¸Œì íŠ¸ êµ¬ì„±ìš”ì†Œ)
```csharp
private float rotationVelocity;

private void Rotate()
{
    // FreeLockCamera
    // Follow, Look atì„ Playerë¡œ
    // top, middle, bottom rigì˜ Body > X/Y/Z Dampingì„ ì „ë¶€ 0ìœ¼ë¡œ.(ì¹´ë©”ë¼ê°€ ëŠ¦ê²Œ ë”°ë¼ê°€ëŠ”ê±° ë°©ì§€)
    // í•„ìš”ì— ë”°ë¼, Y, X axis invert
    // í•„ìš”ì— ë”°ë¼, Orbit rig ì„¤ì •

    // ëŒ€ìƒì´ ë  ì¹´ë©”ë¼ì˜ yì¶• ê°ë„
    float targetRotation = Camera.main.transform.eulerAngles.y;
    // í˜„ì¬ ìºë¦­í„°ì˜ yì¶• ê°ë„ë¥¼ ëŒ€ìƒ ê°ë„(targetRotation)ë¥¼ í–¥í•´ mouseSensitivity ì†ë„ë¡œ íšŒì „ì‹œì¼œì¤€ë‹¤.
    float rotation = Mathf.SmoothDampAngle(transform.eulerAngles.y, targetRotation, ref rotationVelocity, 1/mouseSensitivity);
    // êµ¬í•´ì§„ rotationì„ Quaternion.Eulerì— yì¶• ê°ë„ë¡œ ë„£ì–´ì£¼ê³  transform.rotationì— ì ìš©
    transform.rotation = Quaternion.Euler(0, rotation, 0);
}
```
- `Rigidbody` ì‚¬ìš© ì‹œ ì´ë™:
```csharp
// í‚¤ë³´ë“œ ì´ë™
Vector3 move = transform.right * moveX + transform.forward * moveZ;

rb.MovePosition(rb.position + move * moveSpeed * Time.fixedDeltaTime);
```

<details>
<summary>3ì¸ì¹­ ì‹œì  êµ¬í˜„ ë‹µ í™•ì¸</summary>

```csharp
//FixedUpdate ë‚´ë¶€ì˜ 3ì¸ì¹­ ì‹œì  êµ¬í˜„ ë‹µ
// í‚¤ë³´ë“œ ì´ë™
Vector3 move = transform.right * moveX + transform.forward * moveZ;

rb.MovePosition(rb.position + move * moveSpeed * Time.fixedDeltaTime);

if (move != Vector3.zero)
{
    Rotate();
    Quaternion moveRotation = Quaternion.LookRotation(move);
    childObj.transform.rotation = moveRotation;
}
```

</details>

<details>
<summary>3ì¸ì¹­ ì‹œì  êµ¬í˜„ ë‹µ(ìµœì¢… ì „ì²´ ì½”ë“œ)</summary>

```csharp
using Cinemachine;
using System.Collections;
using System.Collections.Generic;
using UnityEngine;

public class PalyerControllerThirdAns : MonoBehaviour
{
    public float moveSpeed = 5f;
    public float mouseSensitivity = 100f;
    public GroundChecker groundChecker;
    public float jumpForce;

    public CinemachineFreeLook freeLockCamera;

    public GameObject childObj;

    private Rigidbody rb;

    private float rotationVelocity;

    private float moveX;
    private float moveZ;

    void Start()
    {
        rb = GetComponent<Rigidbody>();
        Cursor.lockState = CursorLockMode.Locked;
    }

    void Update()
    {
        moveX = Input.GetAxis("Horizontal");
        moveZ = Input.GetAxis("Vertical");
        if (groundChecker.IsGrounded() && Input.GetButtonDown("Jump"))
        {
            //Debug.Log("ê·¸ë¼ìš´ë“œ ì í”„");
            rb.AddForce(Vector3.up * jumpForce, ForceMode.VelocityChange);
        }
    }

    void FixedUpdate()
    {
        Vector3 move = transform.right * moveX + transform.forward * moveZ;
        //rb.velocity = move * moveSpeed + Vector3.up * rb.velocity.y;
        //rb.AddForce(move * moveSpeed); // ë§ˆì°°ë ¥ìœ¼ë¡œ ì¸í•´ ì´ë™ ì•ˆë¨

        rb.MovePosition(rb.position + move * moveSpeed * Time.fixedDeltaTime);

        if (move != Vector3.zero)
        {
            Rotate();
            Quaternion moveRotation = Quaternion.LookRotation(move);
            childObj.transform.rotation = moveRotation;
        }
    }

    private void Rotate()
    {
        // ëŒ€ìƒì´ ë  ì¹´ë©”ë¼ì˜ yì¶• ê°ë„
        float targetRotation = Camera.main.transform.eulerAngles.y;
        // í˜„ì¬ ìºë¦­í„°ì˜ yì¶• ê°ë„ë¥¼ ëŒ€ìƒ ê°ë„(targetRotation)ë¥¼ í–¥í•´ mouseSensitivity ì†ë„ë¡œ íšŒì „ì‹œì¼œì¤€ë‹¤.
        float rotation = Mathf.SmoothDampAngle(transform.eulerAngles.y, targetRotation, ref rotationVelocity, 1 / mouseSensitivity);
        // êµ¬í•´ì§„ rotationì„ Quaternion.Eulerì— yì¶• ê°ë„ë¡œ ë„£ì–´ì£¼ê³  transform.rotationì— ì ìš©
        transform.rotation = Quaternion.Euler(0, rotation, 0);
    }
}
```

</details>

### ğŸ› ï¸ ì£¼ìš” êµ¬ì„± ìš”ì†Œ 2: ì í”„
- `Rigidbody` ì‚¬ìš© ì‹œ ì í”„: `AddForce. ëª¨ë“œëŠ” ForceMode.VelocityChange` ë˜ëŠ” `velocity` ì œì–´
    - rigidbodyì—ì„œ rotation freeze í•„ìš”
- `CharacterController` ì‚¬ìš© ì‹œ ì í”„: ë¬¼ë¦¬ ì§ì ‘ êµ¬í˜„ í•„ìš”
- ì§€ë©´ì— ìˆì„ ë•Œë§Œ ì í”„ê°€ ê°€ëŠ¥í•˜ê²Œ í•´ì•¼ í•¨.
- ì í”„ í‚¤ ì…ë ¥ ê°ì§€ í•¨ìˆ˜ ê³µí†µ: `Input.GetButtonDown("Jump")`
- ì í”„ í›„ ì‚¬ìš´ë“œ ì¬ìƒ, ì´í™íŠ¸ ì—°ë™ë„ í™•ì¥ ê°€ëŠ¥

### ğŸ’¡ ì£¼ì˜í•  ì 
- `FixedUpdate`ì—ì„œ ì´ë™ê³¼ ì¹´ë©”ë¼ ì´ë™ì„ êµ¬í˜„ í•´ì•¼ ì¹´ë©”ë¼ ë–¨ë¦¼ ë°œìƒì•ˆí•¨.
- `Update`ì—ì„œ ì í”„ë¥¼ êµ¬í˜„í•´ì•¼ í•¨. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´, ì í”„ í‚¤ ì”¹í˜ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥.

### ğŸ’¡ ì§€ë©´ íŒì • íŒ
`isGrounded` í”Œë˜ê·¸ ì²˜ë¦¬. ì•„ë˜ëŠ” ê·¸ ë°©ë²•ë“¤
- `OnCollisionEnter`: ê°€ì¥ ê°„ë‹¨í•¨. but, í”Œë ˆì´ì–´ì˜ ì˜†ê³¼ ë¶€ë”ªí˜€ë„ ì§€ë©´íŒì •í•¨.
- `Physics.Raycast` : ìœ„ì˜ ë¬¸ì œ ì—†ìŒ. but, ê¸‰ë‚™í•˜ ë¬¸ì œ
[ ![í…ìŠ¤íŠ¸](https://velog.velcdn.com/images/nagi0101/post/d2bb6519-dc90-4a91-9b1c-d8fc8d6b646c/image.png) ]( https://velog.velcdn.com/images/nagi0101/post/d2bb6519-dc90-4a91-9b1c-d8fc8d6b646c/image.png )

- `Physics.Boxcast` : ìœ„ 2ê°œ ë¬¸ì œ í•´ê²°. GroundChecker.cs ì˜ˆì‹œ
```csharp
using UnityEngine;

public class GroundChecker : MonoBehaviour
{
    [Header("Boxcast Property")]
    [SerializeField] private Vector3 boxSize;
    [SerializeField] private float maxDistance;
    [SerializeField] private LayerMask groundLayer;

    [Header("Debug")]
    [SerializeField] private bool drawGizmo;

    private void OnDrawGizmos()
    {
        if (!drawGizmo) return;

        Gizmos.color = Color.cyan;
        Gizmos.DrawCube(transform.position - transform.up * maxDistance, boxSize);
    }

    public bool IsGrounded()
    {
        /* BoxCast ë§¤ê°œë³€ìˆ˜ë“¤
         1. Box Rayë¥¼ ë°œì‚¬í•  ì‹œì‘ì 
         2. Box í¬ê¸°ì˜ ì ˆë°˜
         3. Box Rayë¥¼ ë°œì‚¬í•  ë°©í–¥
         4. Boxì˜ íšŒì „ê°’
         5. Box Rayê°€ ê°ˆ ìˆ˜ ìˆëŠ” ìµœëŒ€ ê±°ë¦¬
         6. Box Rayì™€ ì¶©ëŒ íŒì •ì´ ê°€ëŠ¥í•œ Layerë“¤   
         */
        return Physics.BoxCast(transform.position, boxSize / 2.0f, -transform.up, transform.rotation, maxDistance, groundLayer);
    }

}
```
ğŸ¯ `BoxCast` ì„¤ëª…ê¸€: http://theeye.pe.kr/archives/2764

ğŸ¯ `CharacterController`ëŠ” íŠ¹íˆ, ì¤‘ë ¥ ì§ì ‘ êµ¬í˜„ ì‹œ, `isGrounded`ì¼ ê²½ìš°, ì¤‘ë ¥ê°’ ëˆ„ì ì„ ë©ˆì¶°ì•¼ í•¨. ê¸‰ë‚™í•˜ ë°©ì§€ ìœ„í•¨. 

---

## 2. ë¯¸ì…˜ 2: ì•„ì´í…œ ìˆ˜ì§‘ ì‹œìŠ¤í…œ

### âœ… ìš”êµ¬ ì‚¬í•­

- ì”¬ ê³³ê³³ì— ìˆ˜ì§‘ ê°€ëŠ¥í•œ ì•„ì´í…œ ë°°ì¹˜
- í”Œë ˆì´ì–´ê°€ ì•„ì´í…œê³¼ ì¶©ëŒí•˜ë©´ ì‚¬ë¼ì§
- ìˆ˜ì§‘ëœ ê°œìˆ˜ë¥¼ UIë¡œ í‘œì‹œ

### ğŸ› ï¸ ì£¼ìš” êµ¬ì„± ìš”ì†Œ

- ì•„ì´í…œì— `Collider` + `isTrigger` ì„¤ì •
- `OnTriggerEnter(Collider other)` í™œìš©
- `UI Text` ë˜ëŠ” `TMP_Text`ë¡œ ì ìˆ˜ ê°±ì‹ 

---

## 3. í™•ì¥ ì•„ì´ë””ì–´

- ì•„ì´í…œ ìˆ˜ì§‘ ì‹œ, ì†Œë¦¬ ì¶œë ¥
- ì œí•œ ì‹œê°„ ë‚´ ì•„ì´í…œ ìˆ˜ì§‘ ê²Œì„
- ìºë¦­í„° ëª¨ë¸ ë° ìºë¦­í„° ì• ë‹ˆë©”ì´ì…˜ ì‚½ì…
- íŠ¹ì • ê°œìˆ˜ ì´ìƒ ìˆ˜ì§‘ ì‹œ ë‹¤ìŒ ìŠ¤í…Œì´ì§€ ì „í™˜
- ì í”„ ë¯¸ì…˜ê³¼ ìˆ˜ì§‘ ë¯¸ì…˜ì„ í˜¼í•©í•œ í¼ì¦ êµ¬ì„±

---

## âœ… ì™„ë£Œ ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] 3ì¸ì¹­ ì‹œì  ê¸°ëŠ¥ ì •ìƒ ì‘ë™
- [ ] ìºë¦­í„° ì í”„ ê¸°ëŠ¥ ì •ìƒ ì‘ë™
- [ ] ì¤‘ë³µ ì í”„ ë°©ì§€ ë¡œì§ í¬í•¨
- [ ] ì•„ì´í…œ ì¶©ëŒ â†’ ì‚¬ë¼ì§ êµ¬í˜„
- [ ] UIì— ì‹¤ì‹œê°„ ì ìˆ˜ ë°˜ì˜
- [ ] í”Œë ˆì´ì–´ Prefab ì •ë¦¬ ì™„ë£Œ

## âœ… ì‚°ì¶œë¬¼
- ì í”„+ì•„ì´í…œ ìˆ˜ì§‘ 3ì¸ì¹­ ê²Œì„ ë°ëª¨ ì˜ìƒ
- ì í”„+ì•„ì´í…œ ìˆ˜ì§‘ 3ì¸ì¹­ ê²Œì„ ìœ ë‹ˆí‹° í™”ë©´(ì”¬+ê²Œì„ë·°+ìºë¦­í„° ì¡°ì‘ ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ ì¸ìŠ¤í™í„° í™”ë©´)ì„ ìº¡ì³í•œ ì‚¬ì§„ 1ì¥ë§Œ
- ê°„ë‹¨í•œ ê²Œì„ì„¤ëª…ì´ ê°™ì´ ë“¤ì–´ê°„ velogê¸€ ë§í¬ í•˜ë‚˜.

---

## ğŸ”— ì°¸ê³  ìë£Œ
- ë¬´ë£Œ íš¨ê³¼ìŒ ì‚¬ì´íŠ¸: https://soundeffect-lab.info/sound/button/

- [Unity Manual - Rigidbody](https://docs.unity3d.com/Manual/class-Rigidbody.html)
- [Unity Docs - OnTriggerEnter](https://docs.unity3d.com/ScriptReference/Collider.OnTriggerEnter.html)
